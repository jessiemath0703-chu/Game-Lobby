<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jessie Math | 捷析老師 遊戲大廳</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-yellow: #FFD700;
            --text-dark: #2c3e50;
            --text-gray: #636e72;
            --bg-light: #FDFBF7;
            --card-shadow: 0 8px 20px rgba(0,0,0,0.06);
            --radius-main: 24px;
            --dark-blue: #2C3E50;
            
            /* 按鈕系統 */
            --btn-blue: #0984e3; 
            --btn-blue-hover: #74b9ff;
            
            /* 資源彈窗顏色 */
            --modal-game-bg: #00b894;
            --modal-game-hover: #55efc4;
            --modal-video-bg: #ff7675;
            --modal-doc-bg: #fdcb6e;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            /* 全站字體強制使用 Noto Sans TC */
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
            font-weight: 500;
        }

        a { text-decoration: none; color: inherit; }
        button { font-family: 'Noto Sans TC', sans-serif; }

        /* --- Header --- */
        header {
            background: white;
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.03);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-left { display: flex; align-items: center; gap: 15px; }

        .logo-circle {
            width: 55px; height: 55px; border-radius: 50%; overflow: hidden; border: 3px solid #eee;
        }
        .logo-circle img { width: 100%; height: 100%; object-fit: cover; }

        .header-title-group { display: flex; flex-direction: column; }

        .main-title {
            font-size: 1.6rem;
            font-weight: 900;
            color: var(--text-dark);
            line-height: 1.2;
            letter-spacing: -0.5px;
        }

        .sub-title { font-size: 0.9rem; color: var(--text-gray); letter-spacing: 1px; font-weight: 700; }

        .header-nav { display: flex; gap: 20px; align-items: center; }

        .nav-btn {
            padding: 10px 25px; border-radius: 30px; font-weight: 700; font-size: 1rem;
            transition: all 0.3s ease; cursor: pointer;
        }
        .nav-btn.active { background-color: var(--primary-yellow); color: var(--text-dark); box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4); }
        .nav-btn.text-only { background: transparent; color: var(--text-dark); }
        .nav-btn.youtube { color: #d63031; }
        .nav-btn:hover { transform: translateY(-2px); }

        /* --- Intro Section --- */
        .intro-section {
            max-width: 1100px; margin: 60px auto; padding: 0 20px; text-align: center;
        }

        .intro-headline {
            font-size: 2.6rem;
            font-weight: 900;
            color: var(--text-dark);
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .highlight-bg {
            background: linear-gradient(180deg, transparent 65%, var(--primary-yellow) 65%);
            display: inline-block; padding: 0 10px; color: var(--text-dark);
        }

        .intro-subtext {
            color: #636e72; font-size: 1.2rem; margin-bottom: 50px;
            max-width: 800px; margin-left: auto; margin-right: auto;
            font-weight: 500;
        }

        .intro-grid {
            display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 30px; text-align: left;
        }

        /* 左側：冒險指南 */
        .guide-card {
            background: white; border-radius: var(--radius-main); padding: 40px;
            box-shadow: var(--card-shadow); border: 2px solid #fff;
        }

        .guide-title {
            color: #0984e3; font-size: 1.5rem; font-weight: 900; margin-bottom: 20px;
            display: flex; align-items: center; gap: 12px;
        }

        .guide-content p {
            margin-bottom: 20px; font-size: 1.1rem; color: #2d3436; line-height: 1.8; font-weight: 500;
        }

        .highlight-text {
            background-color: #E3F2FD; color: #0984e3; padding: 4px 10px; border-radius: 6px; font-weight: 700;
        }

        .btn-scroll {
            display: inline-block; background-color: #636e72; color: white;
            padding: 12px 25px; border-radius: 12px; margin-top: 10px;
            font-size: 1rem; font-weight: 700; transition: 0.3s;
        }
        .btn-scroll:hover { background-color: #2d3436; transform: translateY(-2px); }

        /* 右側：大廳守則 */
        .rules-card {
            background-color: var(--dark-blue); color: white; border-radius: var(--radius-main);
            padding: 40px; box-shadow: var(--card-shadow);
        }

        .rules-title {
            color: var(--primary-yellow); font-size: 1.5rem; font-weight: 900;
            margin-bottom: 30px; display: flex; align-items: center; gap: 10px;
        }

        .rule-item { display: flex; gap: 15px; margin-bottom: 30px; align-items: flex-start; }

        .check-icon {
            color: var(--primary-yellow); font-size: 1.2rem;
            background: rgba(255, 215, 0, 0.2); border-radius: 50%;
            width: 36px; height: 36px; display: flex; align-items: center; justify-content: center;
            flex-shrink: 0;
        }

        .rule-text h4 { font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; color: white; }
        .rule-text p { font-size: 1rem; color: #b2bec3; margin: 0; }

        /* --- Puzzle Banner --- */
        .puzzle-section { max-width: 1100px; margin: 0 auto 50px; padding: 0 20px; }
        
        .puzzle-banner {
            background: linear-gradient(to right, #fff8e1, #fff);
            border: 3px dashed #ffe082; border-radius: var(--radius-main);
            padding: 25px 40px; display: flex; align-items: center; justify-content: space-between;
        }
        
        .puzzle-text h3 { color: #e67e22; margin-bottom: 5px; font-size: 1.4rem; font-weight: 900; }
        .puzzle-icons { display: flex; gap: 15px; font-size: 2rem; color: #dfe6e9; }
        .puzzle-icons .collected { color: var(--primary-yellow); filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1)); }

        /* --- Grade Navigation --- */
        .grade-nav-container {
            display: flex; justify-content: center; margin-bottom: 50px; padding: 0 20px;
            position: sticky; top: 90px; z-index: 900;
        }

        .grade-nav-bar {
            background: white; padding: 8px 10px; border-radius: 60px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            display: flex; align-items: center; justify-content: center;
            gap: 5px; width: 100%; max-width: 850px;
        }

        .grade-tab-btn {
            flex: 1; text-align: center; padding: 15px 0; border-radius: 40px;
            color: #b2bec3; font-weight: 700; font-size: 1.1rem;
            transition: all 0.3s; cursor: pointer; border: none; background: transparent;
        }

        .grade-tab-btn:hover { color: var(--text-dark); background-color: #f1f2f6; }
        
        .grade-tab-btn.active {
            background-color: var(--dark-blue); color: var(--primary-yellow);
            box-shadow: 0 4px 15px rgba(44, 62, 80, 0.4);
        }

        /* --- Cards Content --- */
        .grade-content {
            max-width: 1200px; margin: 0 auto 100px; padding: 0 20px;
            display: none; animation: slideUp 0.4s ease-out;
        }
        .grade-content.active-section { display: block; }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header { text-align: center; margin-bottom: 50px; }
        .section-header h2 { font-size: 2.2rem; font-weight: 900; color: var(--text-dark); margin-bottom: 10px; }
        .section-header p { color: #636e72; font-size: 1.2rem; font-weight: 500; }

        .cards-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px;
        }

        /* --- Card Design --- */
        .game-card {
            background: white; border-radius: 20px; padding: 30px 25px;
            box-shadow: var(--card-shadow); transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex; flex-direction: column; position: relative;
            min-height: 320px; border: 2px solid white;
        }

        .game-card:hover {
            transform: translateY(-8px); 
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); 
            border-color: #f1f2f6;
        }

        .status-badge {
            align-self: flex-start; padding: 6px 12px; border-radius: 8px;
            font-size: 0.9rem; font-weight: 900; margin-bottom: 20px;
            display: inline-flex; align-items: center; gap: 6px;
        }
        .status-badge.open { background-color: #d1f2e6; color: #00b894; }
        .status-badge.planning { background-color: #fad390; color: #e67e22; }

        .card-title {
            font-size: 1.4rem; font-weight: 900; color: var(--text-dark);
            margin-bottom: 15px; line-height: 1.4; display: flex; align-items: flex-start; gap: 10px;
        }
        .card-title i { margin-top: 5px; font-size: 1.2rem; color: var(--text-dark); }

        .keywords { font-size: 0.95rem; color: #b2bec3; margin-bottom: 25px; flex-grow: 1; font-weight: 500; }

        .card-action { margin-top: auto; }

        .btn-enter {
            background-color: var(--btn-blue); color: white; text-align: center;
            padding: 14px; border-radius: 12px; font-weight: 900; font-size: 1.1rem;
            width: 100%; transition: all 0.2s; border: none; cursor: pointer;
            box-shadow: 0 4px 15px rgba(9, 132, 227, 0.3);
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-enter:hover { background-color: var(--btn-blue-hover); transform: scale(1.02); }

        /* Locked Card */
        .game-card.locked {
            justify-content: center; align-items: center; text-align: center;
            background-color: #fbfbfb; border: 3px dashed #dfe6e9; box-shadow: none;
        }
        .game-card.locked .status-badge { position: absolute; top: 25px; left: 25px; background: #dfe6e9; color: #636e72; }
        .lock-icon { font-size: 3.5rem; color: #b2bec3; margin: 30px 0 15px; }
        .construction-text { color: #b2bec3; font-weight: 700; font-size: 1.2rem; }
        .game-card.locked .card-title { opacity: 0.3; margin-bottom: 0; justify-content: center; }

        /* --- Resource Modal --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(44, 62, 80, 0.8); backdrop-filter: blur(5px);
            z-index: 2000; display: none; /* Hidden by default */
            align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s;
        }

        .modal-content {
            background: white; width: 90%; max-width: 500px;
            border-radius: 30px; padding: 40px; text-align: center;
            position: relative; transform: scale(0.9); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-overlay.active { display: flex; opacity: 1; }
        .modal-overlay.active .modal-content { transform: scale(1); }

        .close-modal-btn {
            position: absolute; top: 20px; right: 20px;
            background: #f1f2f6; border: none; width: 40px; height: 40px; border-radius: 50%;
            font-size: 1.2rem; color: #636e72; cursor: pointer; transition: 0.2s;
        }
        .close-modal-btn:hover { background: #dfe6e9; color: #2d3436; }

        .modal-title { font-size: 1.6rem; font-weight: 900; margin-bottom: 10px; color: var(--dark-blue); }
        .modal-subtitle { color: #636e72; margin-bottom: 25px; font-weight: 500;}

        .modal-options { display: flex; flex-direction: column; gap: 15px; }

        .modal-option-btn {
            display: flex; align-items: center; padding: 18px; border-radius: 16px;
            text-decoration: none; transition: transform 0.2s; color: white; font-weight: 900; font-size: 1.1rem;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1); border: none; cursor: pointer; justify-content: flex-start;
        }
        .modal-option-btn:hover { transform: translateY(-3px); filter: brightness(1.05); }
        
        .modal-option-btn i { font-size: 1.6rem; margin-right: 15px; width: 30px; text-align: center; }

        .btn-modal-game { background: var(--modal-game-bg); }
        .btn-modal-video { background: var(--modal-video-bg); }
        .btn-modal-doc { background: var(--modal-doc-bg); }
        .btn-modal-disabled { background: #b2bec3; cursor: not-allowed; opacity: 0.7; pointer-events: none; }

        /* Footer */
        footer {
            text-align: center; padding: 60px 20px; color: #b2bec3; border-top: 1px solid #eee;
            margin-top: 80px; background: white; font-weight: 500;
        }

        /* RWD */
        @media (max-width: 768px) {
            .intro-grid { grid-template-columns: 1fr; }
            .grade-nav-bar { flex-wrap: wrap; border-radius: 30px; padding: 15px; }
            .header-nav { display: none; }
            .intro-headline { font-size: 2rem; }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-left">
            <div class="logo-circle">
                <img src="JESSIEMATH-Q.PNG.png" alt="Jessie Math Logo">
            </div>
            <div class="header-title-group">
                <div class="main-title">Jessie Math</div>
                <div class="sub-title">捷析數學. 遊戲大廳</div>
            </div>
        </div>
        <nav class="header-nav">
            <a href="https://jessiemath0703-chu.github.io/Game-Lobby/" class="nav-btn active">大廳首頁</a>
            <a href="#" class="nav-btn text-only">關於老師</a>
            <a href="#" class="nav-btn text-only youtube">YouTube 頻道</a>
        </nav>
    </header>

    <section class="intro-section">
        <h1 class="intro-headline">
            學習不是刷題<br>
            <span class="highlight-bg">是一場一關一關的冒險</span>
        </h1>
        <p class="intro-subtext">
            歡迎來到 Math Hall 數學大廳。在這裡，每一個年級都是一個世界，每一個單元，都是一段任務旅程。
        </p>

        <div class="intro-grid">
            <div class="guide-card">
                <div class="guide-title"><i class="fa-solid fa-scroll"></i> 冒險指南</div>
                <div class="guide-content">
                    <p>在數學大廳裡，<span class="highlight-text">孩子用自己的速度前進</span>。</p>
                    <p>你可以先玩遊戲來熟悉概念，也可以搭配影片與任務單進行深度練習。我們不追求秒殺題目，而是追求真正的理解。</p>
                </div>
                <a href="#" class="btn-scroll"><i class="fa-regular fa-folder-open"></i> 領取任務卷軸 (PDF 下載)</a>
            </div>

            <div class="rules-card">
                <div class="rules-title"><i class="fa-solid fa-shield-halved"></i> 大廳守則</div>
                <div class="rule-item">
                    <div class="check-icon"><i class="fa-solid fa-check"></i></div>
                    <div class="rule-text"><h4>每一關都能重來</h4><p>失敗只是還沒成功，多試幾次！</p></div>
                </div>
                <div class="rule-item">
                    <div class="check-icon"><i class="fa-solid fa-check"></i></div>
                    <div class="rule-text"><h4>先理解，再求快</h4><p>想清楚規則比亂按更重要。</p></div>
                </div>
                <div class="rule-item">
                    <div class="check-icon"><i class="fa-solid fa-check"></i></div>
                    <div class="rule-text"><h4>比昨天的自己強</h4><p>這是屬於你的冒險，不是比賽。</p></div>
                </div>
            </div>
        </div>
    </section>

    <section class="puzzle-section">
        <div class="puzzle-banner">
            <div class="puzzle-text">
                <h3><i class="fa-solid fa-puzzle-piece"></i> 收集你的冒險拼圖</h3>
                <p style="color: #636e72; font-size: 1rem; font-weight: 500;">完成單元挑戰，集滿拼圖可解鎖神秘圖形！</p>
            </div>
            <div class="puzzle-icons">
                <i class="fa-solid fa-puzzle-piece collected"></i>
                <i class="fa-solid fa-puzzle-piece"></i>
                <i class="fa-solid fa-puzzle-piece"></i>
                <i class="fa-solid fa-lock"></i>
            </div>
        </div>
    </section>

    <div class="grade-nav-container">
        <div class="grade-nav-bar">
            <button class="grade-tab-btn" data-target="grade-1">一年級</button>
            <button class="grade-tab-btn" data-target="grade-2">二年級</button>
            <button class="grade-tab-btn" data-target="grade-3">三年級</button>
            <button class="grade-tab-btn" data-target="grade-4">四年級</button>
            <button class="grade-tab-btn" data-target="grade-5">五年級</button>
            <button class="grade-tab-btn active" data-target="grade-6">六年級</button>
        </div>
    </div>

    <section id="grade-1" class="grade-content">
        <div class="section-header"><h2>一年級萌新村</h2><p>數字的起點，快樂的出發！</p></div>
        <div class="cards-grid" id="g1-container"></div>
    </section>

    <section id="grade-2" class="grade-content">
        <div class="section-header"><h2>二年級試煉場</h2><p>加減乘除，勇往直前！</p></div>
        <div class="cards-grid" id="g2-container"></div>
    </section>

    <section id="grade-3" class="grade-content">
        <div class="section-header"><h2>三年級冒險島</h2><p>探索分數與幾何的新世界。</p></div>
        <div class="cards-grid" id="g3-container"></div>
    </section>

    <section id="grade-4" class="grade-content">
        <div class="section-header"><h2>四年級勇者城</h2><p>大數運算，邏輯升級！</p></div>
        <div class="cards-grid" id="g4-container"></div>
    </section>

    <section id="grade-5" class="grade-content">
        <div class="section-header"><h2>五年級探險區</h2><p>累積運算實力，準備迎接挑戰。</p></div>
        <div class="cards-grid" id="g5-container"></div>
    </section>

    <section id="grade-6" class="grade-content active-section">
        <div class="section-header">
            <h2>六年級大冒險</h2>
            <p>「六年級，是速度、比例與未知數開始奔跑的一年。」</p>
        </div>
        <div class="cards-grid" id="g6-container"></div>
    </section>

    <footer>
        <p>&copy; 2025 Jessie Math 捷析老師. All rights reserved.</p>
        <p>數學不迷路，Jessie 帶你走。</p>
    </footer>

    <div class="modal-overlay" id="resourceModal">
        <div class="modal-content">
            <button class="close-modal-btn" onclick="closeModal()"><i class="fa-solid fa-xmark"></i></button>
            <h3 class="modal-title" id="modalTitle">單元標題</h3>
            <p class="modal-subtitle">請選擇你要進行的任務：</p>
            
            <div class="modal-options">
                <div id="modalGameContainer" style="display: flex; flex-direction: column; gap: 10px;"></div>

                <a href="#" id="modalVideoBtn" class="modal-option-btn btn-modal-video" target="_blank">
                    <i class="fa-brands fa-youtube"></i> 觀看影片 (建構中)
                </a>
                <a href="#" id="modalDocBtn" class="modal-option-btn btn-modal-doc" target="_blank">
                    <i class="fa-solid fa-file-pdf"></i> 任務文檔 (建構中)
                </a>
            </div>
        </div>
    </div>

    <script>
        // --- 1. 定義單元資料 ---
        // games 陣列可放多個遊戲 { label: "按鈕文字", url: "連結" }
        // video 和 doc 若為 "#" 則會顯示為建構中
        
        const unitsData = {
            // --- 五年級 ---
            "g5-u1": {
                title: "單元一：基礎運算挑戰",
                keywords: "關鍵字：整數四則運算、括號應用",
                games: [
                    { label: "基礎挑戰", url: "https://jessiemath0703-chu.github.io/game6-1/" },
                    { label: "困難挑戰", url: "https://jessiemath0703-chu.github.io/game6-1-1/" }
                ],
                video: "#",
                doc: "#"
            },
            
            // --- 六年級 ---
            "g6-u1": {
                title: "單元一：最大公因數",
                keywords: "關鍵字：短除法、互質、應用問題",
                games: [
                    { label: "複習五年級基礎", url: "https://jessiemath0703-chu.github.io/game6-1/" }
                ],
                video: "#",
                doc: "#"
            },
            // 單元 2~5 建構中 (不寫入 data 就會自動變鎖定卡片)

            "g6-u6": {
                title: "單元六：兩量關係與比",
                keywords: "關鍵字：數量關係、正比、列表找規律",
                games: [
                    { label: "基礎挑戰", url: "https://jessiemath0703-chu.github.io/game6-2/" },
                    { label: "進階挑戰", url: "https://jessiemath0703-chu.github.io/game6-2-1/" }
                ],
                video: "#",
                doc: "#"
            },
            "g6-u7": {
                title: "單元七：圓周長與扇形",
                keywords: "關鍵字：幾何圖形、周長計算",
                games: [
                    { label: "基礎挑戰", url: "https://jessiemath0703-chu.github.io/game6-3/" },
                    { label: "困難挑戰", url: "https://jessiemath0703-chu.github.io/game6-3-1/" }
                ],
                video: "#",
                doc: "#"
            },
            "g6-u8": {
                title: "單元八：放大縮小",
                keywords: "關鍵字：地圖應用、比例計算",
                games: [
                    { label: "基礎挑戰", url: "https://jessiemath0703-chu.github.io/game6-5/" },
                    { label: "進階挑戰", url: "https://jessiemath0703-chu.github.io/game6-5-1/" }
                ],
                video: "#",
                doc: "#"
            },
            "g6-u9": {
                title: "單元九：怎樣解題",
                keywords: "關鍵字：邏輯思考、步驟拆解",
                games: [
                    { label: "基礎挑戰", url: "https://jessiemath0703-chu.github.io/game6-9/" },
                    { label: "困難挑戰", url: "https://jessiemath0703-chu.github.io/game6-9-1/" }
                ],
                video: "#",
                doc: "#"
            }
        };

        // --- 2. 產生卡片函數 ---

        function createActiveCard(unitId, gradePrefix, unitNum) {
            const data = unitsData[unitId];
            if (!data) return createLockedCard(unitNum);

            return `
            <div class="game-card">
                <span class="status-badge open"><i class="fa-solid fa-check"></i> 已開放</span>
                <h3 class="card-title"><i class="fa-solid fa-cube"></i> ${data.title}</h3>
                <p class="keywords">${data.keywords}</p>
                <div class="card-action">
                    <button class="btn-enter" onclick="openModal('${unitId}')">
                        進入島嶼 <i class="fa-solid fa-arrow-right"></i>
                    </button>
                </div>
            </div>
            `;
        }

        function createLockedCard(unitNum) {
            // 如果是 G6 的特定單元，可以顯示特定標題 (選擇性)
            return `
            <div class="game-card locked">
                <span class="status-badge planning">籌備中</span>
                <h3 class="card-title">單元${unitNum}：神秘主題</h3>
                <div class="lock-icon"><i class="fa-solid fa-lock"></i></div>
                <p class="construction-text">建設中...</p>
                <p class="keywords" style="margin-top:10px; opacity:0.5;">關鍵字：???</p>
            </div>
            `;
        }

        // --- 3. 彈窗邏輯 (動態生成按鈕) ---
        const modal = document.getElementById('resourceModal');
        const modalTitle = document.getElementById('modalTitle');
        const gameContainer = document.getElementById('modalGameContainer');
        const btnVideo = document.getElementById('modalVideoBtn');
        const btnDoc = document.getElementById('modalDocBtn');

        function openModal(unitId) {
            const data = unitsData[unitId];
            if (!data) return;

            // 1. 設定標題
            modalTitle.textContent = data.title;

            // 2. 動態生成遊戲按鈕
            gameContainer.innerHTML = ''; // 清空舊按鈕
            if (data.games && data.games.length > 0) {
                data.games.forEach(game => {
                    const btn = document.createElement('a');
                    btn.className = 'modal-option-btn btn-modal-game';
                    btn.href = game.url;
                    btn.target = '_blank';
                    btn.innerHTML = `<i class="fa-solid fa-gamepad"></i> ${game.label}`;
                    gameContainer.appendChild(btn);
                });
            } else {
                gameContainer.innerHTML = '<p style="color:#999;">暫無遊戲連結</p>';
            }

            // 3. 設定影片與文檔按鈕
            setupModalButton(btnVideo, data.video);
            setupModalButton(btnDoc, data.doc);

            // 4. 顯示彈窗
            modal.classList.add('active');
        }

        function setupModalButton(btnElement, link) {
            if (link && link !== "#") {
                btnElement.href = link;
                btnElement.classList.remove('btn-modal-disabled');
                btnElement.style.pointerEvents = "auto";
            } else {
                btnElement.href = "#";
                btnElement.classList.add('btn-modal-disabled');
                btnElement.style.pointerEvents = "none";
            }
        }

        function closeModal() {
            modal.classList.remove('active');
        }

        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });


        // --- 4. 初始化 ---
        function fillGrade(containerId, gradePrefix, totalUnits) {
            const container = document.getElementById(containerId);
            let html = "";
            for (let i = 1; i <= totalUnits; i++) {
                const uid = `${gradePrefix}-u${i}`;
                if (unitsData[uid]) {
                    html += createActiveCard(uid, gradePrefix, i);
                } else {
                    html += createLockedCard(i);
                }
            }
            container.innerHTML = html;
        }

        document.addEventListener("DOMContentLoaded", () => {
            fillGrade("g1-container", "g1", 20);
            fillGrade("g2-container", "g2", 20);
            fillGrade("g3-container", "g3", 20);
            fillGrade("g4-container", "g4", 20);
            fillGrade("g5-container", "g5", 20);
            fillGrade("g6-container", "g6", 15);

            const tabs = document.querySelectorAll('.grade-tab-btn');
            const sections = document.querySelectorAll('.grade-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    sections.forEach(sec => sec.classList.remove('active-section'));
                    const targetId = tab.getAttribute('data-target');
                    document.getElementById(targetId).classList.add('active-section');
                });
            });
        });
    </script>
</body>
</html>